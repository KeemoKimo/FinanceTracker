<html lang="en">

<head>
    <style>
        html {
            scroll-behavior: smooth;
        }
    </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="mainPage.css">
    <link rel="stylesheet" href="cssInfoDiv.css ">
    <link rel="stylesheet" href="tableCSS.css">
    <link rel="stylesheet" href="AddData.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <script src="./JS/mainPageJS.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js">
    </script>
    <title>Finance Tracker</title>
</head>

<body>
    <div class="mainDiv">

        <div class="div_down">
            <center>
                <div class="mainGraphDiv">
                    <div class="mainDiv_topInfo">
                        <h2 id="lblAmount">Amount</h2>
                    </div>
                    <div class="mainDiv_bottonGraph">
                        <canvas id="myChart" style="width:100%;max-width:90%;height: 100%;"></canvas>
                    </div>
                </div>
            </center>
            <div class="wrapper_info_div">
                <div class="totalIncomeContainer">
                    <h2>Total Income</h2>
                    <div class="inside_divider_income"></div>
                    <h2 style="font-weight: 300;" id="lblInfoIncome">$ Income</h2>
                </div>
                <div class="totalExpensesContainer">
                    <h2>Total Expenses</h2>
                    <div class="inside_divider_expenses"></div>
                    <h2 style="font-weight: 300;" id="lblInfoExpenses">$ Expenses</h2>
                </div>
                <div class="totalSavedContainer">
                    <h2>Total Saved</h2>
                    <div class="inside_divider_saved"></div>
                    <h2 style="font-weight: 300;" id="lblInfoSaved">$ Saved</h2>
                </div>
                <div class="totalInvestedContainer">
                    <h2>Total Invested</h2>
                    <div class="inside_divider_invested"></div>
                    <h2 style="font-weight: 300;" id="lblInfoInvested">$ Invested</h2>
                </div>

            </div>
            <center>
                <div style="height: 1px; width: 90%;background-color: black;" class="dividerLine"></div>
            </center>
            <center>
                <div class="div_up">
                    <input type="text" id="txtSearch" placeholder="Search ...">
                    <div id="addEntry" onclick="scrollToView()">
                        <p>+ Add Entry</p>
                    </div>
                </div>
            </center>
            <center>
                <p id="pSwitchTable" onclick="switchToSavingsView()">
                    Switch to Saving/Investing View
                </p>
            </center>
            <center>
                <div class="divTables">
                    <table id="tblData" cellspacing="0">
                        <colgroup>
                            <col style="background-color: #DFBBB1;" />
                            <col style="background-color: #ADF6B1;" />
                            <col style="background-color: #FF4B3E;" />
                            <col style="background-color: #F8F4F9;" />
                        </colgroup>
                        <tr>
                            <th class="th_TimeRange">Time Range</th>
                            <th class="th_Income">Income</th>
                            <th>Expenses</th>
                            <th class="th_Balance">Balance</th>
                        </tr>
                        <tr id="tr_Default">
                            <td>start - end</td>
                            <td>$ income</td>
                            <td>$ expenses</td>
                            <td><b>$ balance</b></td>
                        </tr>
                    </table>
                    <table id="tblSavings" cellspacing="0">
                        <colgroup>
                            <col style="background-color: #DFBBB1;" />
                            <col style="background-color: #E9D985;" />
                            <col style="background-color: #92DCE5;" />
                        </colgroup>
                        <tr>
                            <th class="th_TimeRange">Time Range</th>
                            <th class="th_Saved">Amount Saved</th>
                            <th class="th_Invested">Amount Invested</th>
                        </tr>
                        <tr id="tr_Default_savings">
                            <td>start - end</td>
                            <td>$ saved</td>
                            <td>$ invested</td>
                        </tr>
                    </table>
                </div>
            </center>
            <div style="height: 50px;"></div>
            <center>
                <div id="addDataDiv">
                    <p style="padding-top: 50px;font-size: 21px;">Time Range</p>
                    <div class="dateRangeDiv">
                        <input type="date" id="dateStart" required>
                        <p style="font-size: 21px;margin-left: 50px;margin-right: 50px;"> to </p>
                        <input type="date" id="dateEnd" required>
                    </div>
                    <div class="addIncome">
                        <p style="font-size: 21px;">Add Income</p>
                        <div class="textbox_income">
                            <input type="number" placeholder="Enter total income...." id="txtIncome" required>
                            <p>$</p>
                        </div>
                    </div>
                    <div class="addExpenses">
                        <p style="font-size: 21px;">Add Expenses</p>
                        <div class="textbox_expenses">
                            <input type="number" placeholder="Enter total expenses...." id="txtExpenses" required>
                            <p>$</p>
                        </div>
                    </div>
                    <div class="addSavings">
                        <p style="font-size: 21px;">Add Savings</p>
                        <div class="textbox_savings">
                            <input type="number" placeholder="Enter new saving amount...." id="txtSavings" required>
                            <p>$</p>
                        </div>
                    </div>
                    <div class="addInvested">
                        <p style="font-size: 21px;">Add Invested</p>
                        <div class="textbox_invested">
                            <input type="number" placeholder="Enter new investment amount...." id="txtInvested"
                                required>
                            <p>$</p>
                        </div>
                    </div>
                    <button id="btnAddEntry" onclick="addEntry()">Add Entry</button>
                </div>
            </center>
        </div>
    </div>

    <script>

        var arrIncome = []
        var arrExpenses = []
        var arrBalances = []
        var arrSavings = []
        var arrInvested = []
        var arrTimeFrame = []
        var totalIncome = 0
        var totalExpenses = 0
        var totalSaved = 0
        var totalInvested = 0
        var totalAmount = 0

        function GetCellValues() {
            var table = document.getElementById('tblData');
            for (var i = 1; i < table.rows.length - 1; i++) {
                var individualTimeFrame = table.rows[i].cells[0].innerHTML
                var individualIncome = Number(table.rows[i].cells[1].innerHTML.replace("$", ""))
                var individualExpenses = Number(table.rows[i].cells[2].innerHTML.replace("$", ""))
                var individualBalance = ((table.rows[i].cells[3].innerHTML.replace("$", "")).replace("<b>", "")).replace("</b>", "")
                arrIncome.push(individualIncome)
                arrExpenses.push(individualExpenses)
                arrBalances.push(individualBalance)
                totalIncome += individualIncome
                totalExpenses += individualExpenses
                totalAmount = totalIncome - totalExpenses
                if (table.rows[i].cells[0].innerHTML.localeCompare(arrTimeFrame[i]) != 0) {
                    arrTimeFrame.push(individualTimeFrame)
                } else {
                    continue;
                }
            }
            var tableSavings = document.getElementById('tblSavings')
            for (var i = 1; i < tableSavings.rows.length - 1; i++) {
                var individualSavings = Number(tableSavings.rows[i].cells[1].innerHTML.replace("$", ""))
                var individualInvested = Number(tableSavings.rows[i].cells[2].innerHTML.replace("$", ""))
                arrSavings.push(individualSavings)
                arrInvested.push(individualInvested)
                totalSaved += individualSavings
                totalInvested += individualInvested
            }
            // for(var i = 1; i<arrIncome.length;i++){
            //     console.log("Income : " + arrIncome[i])
            // }
            // for(var i = 1 ; i < arrExpenses.length; i++){
            //     console.log("Expenses : " + arrExpenses[i])
            // }
            document.getElementById("lblInfoIncome").innerHTML = "$ " + totalIncome
            document.getElementById("lblInfoExpenses").innerHTML = "$ " + totalExpenses
            document.getElementById("lblInfoSaved").innerHTML = "$ " + totalSaved
            document.getElementById("lblInfoInvested").innerHTML = "$ " + totalInvested
            if (totalAmount > 0) {
                document.getElementById("lblAmount").style.color = "green"
            }else{
                document.getElementById("lblAmount").style.color = "red"
            }
            document.getElementById("lblAmount").innerHTML = "$ " + totalAmount
            // console.log("Total Income : " + totalIncome)
            // console.log("Total Expenses : " + totalExpenses)
            // console.log("Total Saved : " + totalSaved)
            // console.log("Total Invested : " + totalInvested)
            clearAddDataDiv()
            myChart.data.labels = arrTimeFrame.reverse()
            myChart.data.datasets[0].data = arrIncome.reverse()
            myChart.data.datasets[1].data = arrExpenses.reverse()
            myChart.data.datasets[2].data = arrSavings.reverse()
            myChart.data.datasets[3].data = arrInvested.reverse()
            arrTimeFrame = []
            arrIncome = []
            arrExpenses = []
            arrSavings = []
            arrInvested = []
            totalIncome = 0
            totalExpenses = 0
            totalSaved = 0
            totalInvested = 0
            totalAmount = 0
            myChart.update()
        }


        var myChart = new Chart("myChart", {
            type: "line",
            data: {
                labels: arrTimeFrame,
                datasets: [
                    {
                        data: arrIncome,
                        borderColor: "#ADF6B1",
                        fill: false
                    }, {
                        data: arrExpenses,
                        borderColor: "#FF4B3E",
                        fill: false
                    }, {
                        data: arrSavings,
                        borderColor: "#E9D985",
                        fill: false
                    }, {
                        data: arrInvested,
                        borderColor: "#92DCE5",
                        fill: false
                    }]
            },
            options: {
                legend: { display: false }
            }
        });
    </script>
</body>

</html>